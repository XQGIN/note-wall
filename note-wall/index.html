<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>温馨提醒墙</title>
    <link rel="icon" href="icon/heart.png" type="image/png">
    <style>
        /* CSS变量定义 - 主题系统 */
        :root {
            /* 白天主题变量 */
            --bg-gradient-day: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #feca57 75%, #48c9b0 100%);
            --glass-bg-day: rgba(255, 255, 255, 0.15);
            --glass-border-day: rgba(255, 255, 255, 0.2);
            --glass-shadow-day: 0 8px 32px rgba(0, 0, 0, 0.1);
            --text-color-day: white;
            --text-shadow-day: 0 1px 3px rgba(255, 255, 255, 0.8), 0 0 10px rgba(255, 255, 255, 0.5);
            
            /* 夜间主题变量 */
            --bg-gradient-night: linear-gradient(135deg, #0f0c29 0%, #302b63 25%, #24243e 50%, #2c3e50 75%, #34495e 100%);
            --glass-bg-night: rgba(0, 0, 0, 0.25);
            --glass-border-night: rgba(255, 255, 255, 0.1);
            --glass-shadow-night: 0 8px 32px rgba(0, 0, 0, 0.3);
            --text-color-night: rgba(255, 255, 255, 0.9);
            --text-shadow-night: 0 1px 3px rgba(0, 0, 0, 0.8), 0 0 10px rgba(0, 0, 0, 0.5);
            
            /* 当前主题变量（默认白天） */
            --current-bg-gradient: var(--bg-gradient-day);
            --current-glass-bg: var(--glass-bg-day);
            --current-glass-border: var(--glass-border-day);
            --current-glass-shadow: var(--glass-shadow-day);
            --current-text-color: var(--text-color-day);
            --current-text-shadow: var(--text-shadow-day);
        }
        
        /* 夜间主题样式 */
        body.night-theme {
            --current-bg-gradient: var(--bg-gradient-night);
            --current-glass-bg: var(--glass-bg-night);
            --current-glass-border: var(--glass-border-night);
            --current-glass-shadow: var(--glass-shadow-night);
            --current-text-color: var(--text-color-night);
            --current-text-shadow: var(--text-shadow-night);
        }
        
        /* 主题切换动画 */
        body {
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "微软雅黑", sans-serif;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }

        /* 背景容器 */
        .background-container {
            position: relative;
            min-height: 100vh;
            width: 100%;
        }

        /* 动态背景层 */
        .background-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--current-bg-gradient);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            z-index: -2;
        }

        /* 背景动画 */
        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* 背景装饰元素 */
        .background-layer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.3) 0%, transparent 25%),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.2) 0%, transparent 20%);
            animation: floatingElements 15s ease-in-out infinite;
        }


        @keyframes floatingElements {

            0%,
            100% {
                transform: translate(0, 0) scale(1) rotate(0deg);
                opacity: 0.8;
            }

            16.6% {
                transform: translate(15px, -15px) scale(1.2) rotate(60deg);
                opacity: 1;
            }

            33.3% {
                transform: translate(-20px, 10px) scale(0.8) rotate(120deg);
                opacity: 0.6;
            }

            50% {
                transform: translate(10px, 20px) scale(1.1) rotate(180deg);
                opacity: 0.9;
            }

            66.6% {
                transform: translate(-15px, -5px) scale(0.9) rotate(240deg);
                opacity: 0.7;
            }

            83.3% {
                transform: translate(5px, -20px) scale(1.05) rotate(300deg);
                opacity: 0.95;
            }
        }

        .glass-window {
            position: absolute;
            background: var(--current-glass-bg);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid var(--current-glass-border);
            border-radius: 20px;
            box-shadow: var(--current-glass-shadow);
            padding: 20px;
            min-width: 200px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            animation: float 6s ease-in-out infinite;
            z-index: 10;
        }

        .glass-window::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0.15) 0%,
                    rgba(255, 255, 255, 0.05) 50%,
                    transparent 100%);
            pointer-events: none;
        }

        .tip-text {
            color: var(--current-text-color);
            text-shadow: var(--current-text-shadow);
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            line-height: 1.4;
            word-wrap: break-word;
            padding: 12px;
            background: transparent;
            border-radius: 10px;
            z-index: 1;
            max-width: 100%;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        .fade-out {
            animation: fadeOut 0.5s ease-in-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        .float-animation {
            animation: float 2s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translate(0, 0);
            }

            25% {
                transform: translate(3px, -3px);
            }

            50% {
                transform: translate(-3px, 3px);
            }

            75% {
                transform: translate(3px, 3px);
            }
        }

        .controls-button {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2000;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
            padding: 20px 40px;
            border-radius: 30px;
            box-shadow: 
                0 8px 32px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.4),
                inset 0 -1px 0 rgba(255, 255, 255, 0.1);
            text-align: center;
            transition: all 0.5s ease;
            cursor: pointer;
            font-weight: bold;
            font-size: 18px;
            color: var(--current-text-color);
            border: 1px solid rgba(255, 255, 255, 0.18);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            overflow: hidden;
            text-shadow: var(--current-text-shadow);
        }

        .controls-button::before {
            z-index: -1;
        }

        .controls-button::after {
            z-index: -1;
        }

        .controls-button.hidden {
            opacity: 0 !important;
            transform: translate(-50%, -50%) scale(0.8) !important;
            pointer-events: none !important;
            margin-top: 0 !important;
        }

        .controls-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0.3) 0%,
                    rgba(255, 255, 255, 0.1) 50%,
                    transparent 100%);
            pointer-events: none;
            border-radius: 30px 30px 0 0;
        }

        .controls-button::after {
            content: '';
            position: absolute;
            top: 10%;
            left: 10%;
            right: 10%;
            bottom: 10%;
            background: linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.2) 0%, 
                    rgba(255, 255, 255, 0.05) 50%, 
                    rgba(255, 255, 255, 0) 100%);
            border-radius: 25px;
            pointer-events: none;
            z-index: 1;
        }

        .controls-button:hover {
            transform: translate(-50%, -50%) translateY(-3px) scale(1.02);
            box-shadow:
                0 15px 35px rgba(31, 38, 135, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15),
                0 0 20px rgba(255, 255, 255, 0.2);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.35) 0%, rgba(255, 255, 255, 0.15) 100%);
        }

        .controls-button:active {
            transform: translate(-50%, -50%) translateY(-1px) scale(0.98);
            box-shadow:
                0 8px 25px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.4),
                inset 0 -1px 0 rgba(255, 255, 255, 0.1);
        }

        /* 响应式设计 - 平板设备 */
        @media screen and (max-width: 768px) {
            .glass-window {
                min-width: 160px;
                min-height: 70px;
                padding: 15px;
                backdrop-filter: blur(25px);
                -webkit-backdrop-filter: blur(25px);
            }

            .tip-text {
                font-size: 12px;
                padding: 8px;
            }

            .controls-button {
                padding: 15px 30px;
                backdrop-filter: blur(25px);
                -webkit-backdrop-filter: blur(25px);
                background: linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
                box-shadow: 
                    0 8px 28px rgba(31, 38, 135, 0.18),
                    inset 0 1px 0 rgba(255, 255, 255, 0.35),
                    inset 0 -1px 0 rgba(255, 255, 255, 0.08);
            }
        }

        /* 响应式设计 - 手机设备 */
        @media screen and (max-width: 480px) {
            .glass-window {
                min-width: 140px;
                min-height: 60px;
                padding: 12px;
                border-radius: 15px;
                backdrop-filter: blur(20px);
                -webkit-backdrop-filter: blur(20px);
            }

            .glass-window::before {
                border-radius: 15px;
            }

            .tip-text {
                font-size: 11px;
                padding: 6px;
                line-height: 1.3;
            }

            .controls-button {
                padding: 12px 25px;
                border-radius: 20px;
                backdrop-filter: blur(20px);
                -webkit-backdrop-filter: blur(20px);
                background: linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
                box-shadow: 
                    0 8px 24px rgba(31, 38, 135, 0.15),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3),
                    inset 0 -1px 0 rgba(255, 255, 255, 0.05);
            }

            .controls-button::before {
                top: 0;
                left: 0;
                right: 0;
                height: 50%;
                border-radius: 15px 15px 0 0;
            }

            @keyframes float {

                0%,
                100% {
                    transform: translate(0, 0);
                }

                25% {
                    transform: translate(2px, -2px);
                }

                50% {
                    transform: translate(-2px, 2px);
                }

                75% {
                    transform: translate(2px, 2px);
                }
            }
        }

        /* 响应式设计 - 超小屏幕设备 */
        @media screen and (max-width: 320px) {
            .glass-window {
                min-width: 120px;
                min-height: 50px;
                padding: 10px;
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
            }

            .tip-text {
                font-size: 10px;
                padding: 5px;
            }

            .controls-button {
                padding: 10px 20px;
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
                background: linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
                box-shadow: 
                    0 8px 20px rgba(31, 38, 135, 0.12),
                    inset 0 1px 0 rgba(255, 255, 255, 0.25),
                    inset 0 -1px 0 rgba(255, 255, 255, 0.03);
            }
        }
    </style>
</head>

<body>
    <div class="background-container">
        <!-- 动态背景层 -->
        <div class="background-layer"></div>

        <!-- 主内容区域 -->
        <button id="startButton" class="controls-button" onclick="startNoteWall()">你准备好了吗？</button>
    </div>

    <script>
        // 等待DOM加载完成
        document.addEventListener('DOMContentLoaded', function () {
            // 获取所有具有玻璃效果的元素
            const glassElements = document.querySelectorAll('.glass-window, .controls-button');

            // 添加鼠标跟随光效
            document.addEventListener('mousemove', function (e) {
                const mouseX = e.clientX;
                const mouseY = e.clientY;

                glassElements.forEach(element => {
                    // 跳过按钮元素，不应用鼠标跟随效果
                    if (element.classList.contains('controls-button')) {
                        return;
                    }

                    const rect = element.getBoundingClientRect();
                    const elementX = rect.left + rect.width / 2;
                    const elementY = rect.top + rect.height / 2;

                    // 计算鼠标与元素中心的距离
                    const distance = Math.sqrt(
                        Math.pow(mouseX - elementX, 2) +
                        Math.pow(mouseY - elementY, 2)
                    );

                    // 根据距离调整光效强度
                    const maxDistance = 300;
                    const intensity = Math.max(0, 1 - distance / maxDistance);

                    // 添加光效
                    if (intensity > 0) {
                        const angle = Math.atan2(mouseY - elementY, mouseX - elementX);
                        const offsetX = Math.cos(angle) * intensity * 8;
                        const offsetY = Math.sin(angle) * intensity * 8;

                        element.style.transform = `translateY(-5px) translateX(${offsetX}px) translateY(${offsetY}px)`;
                        element.style.boxShadow = `
                            0 ${15 + intensity * 10}px ${35 + intensity * 15}px rgba(0, 0, 0, ${0.15 + intensity * 0.1}),
                            inset 0 1px 0 rgba(255, 255, 255, ${0.3 + intensity * 0.2}),
                            0 0 ${20 + intensity * 20}px rgba(255, 255, 255, ${intensity * 0.1})
                        `;
                    } else {
                        // 重置样式
                        element.style.transform = '';
                        element.style.boxShadow = `
                            0 8px 32px rgba(0, 0, 0, 0.1),
                            inset 0 1px 0 rgba(255, 255, 255, 0.2)
                        `;
                    }
                });
            });

            // 添加页面加载动画
            const allElements = document.querySelectorAll('.controls-button');

            // 初始状态设置为透明
            allElements.forEach((element, index) => {
                element.style.opacity = '0';
                element.style.transform = 'translate(-50%, -50%) scale(0.9)';

                // 延迟显示每个元素
                setTimeout(() => {
                    element.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    element.style.opacity = '1';
                    element.style.transform = 'translate(-50%, -50%) scale(1)';
                }, 100 * index);
            });

            // 添加窗口大小变化时的响应
            window.addEventListener('resize', function () {
                // 重新计算玻璃效果
                if (typeof updateGlassEffect === 'function') {
                    updateGlassEffect();
                }
            });

            // 添加滚动视差效果
            window.addEventListener('scroll', function () {
                const scrolled = window.pageYOffset;
                const parallax = document.querySelector('.background-layer');

                if (parallax) {
                    // 视差滚动效果
                    parallax.style.transform = `translateY(${scrolled * 0.5}px)`;
                }
            });
        });

        // 温馨提示文本
        const tips = [
            // 原有的提示
            "多喝水呀~", "保持微笑", "每天都要元气满满", "保持好心情", "好好爱自己",
            "梦想成真", "顺顺利利", "早点休息", "愿所有烦恼都消失", "别熬夜", "注意保暖",
            "远离垃圾人和垃圾事", "要微笑", "要开心", "要快乐", "要健康", "要平安", "要顺利",
            "要幸福", "要好运",

            // 一、直接鼓励与关怀类
            "记得吃早餐", "早点睡觉哦", "照顾好自己", "别太累着了", "记得休息一下",
            "要好好吃饭", "出门注意安全", "对自己好一点", "别想太多啦", "放宽心",

            // 二、积极心态与情绪类
            "一切都会好的", "今天也要加油呀", "没什么大不了", "你是最棒的", "相信你自己",
            "阳光总在风雨后", "简单点，开心点", "心向阳光", "知足常乐", "拥抱今天",

            // 三、美好祝愿与目标类
            "万事胜意", "心想事成", "好运连连", "前程似锦", "未来可期",
            "一切如愿", "烦恼退散", "日日是好日", "所愿皆所得", "苦尽甘来",

            // 四、爱自己与个人成长类
            "取悦自己最重要", "你的感受很重要", "学会拒绝", "忠于内心", "你值得被爱",
            "做自己的太阳", "与自己和解", "内心丰盈", "活得通透", "珍惜当下",

            // 五、精简单句"要XX"格式
            "要自信", "要努力", "要坚强", "要勇敢", "要洒脱",
            "要精致", "要温柔", "要向上", "要酷", "要稳"
        ];

        let windows = [];
        let windowCount = 150; // 默认窗口数量
        let isRunning = false;

        // 根据屏幕尺寸调整窗口数量和参数
        function adjustForScreenSize() {
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;

            if (screenWidth <= 320) {
                // 超小屏幕设备
                windowCount = 15;
            } else if (screenWidth <= 480) {
                // 手机设备
                windowCount = 50;
            } else if (screenWidth <= 768) {
                // 平板设备
                windowCount = 100;
            } else {
                // 桌面设备
                windowCount = 150;
            }
        }

        // 初始化时调整屏幕尺寸
        adjustForScreenSize();

        // 窗口大小变化时重新调整
        window.addEventListener('resize', function () {
            adjustForScreenSize();
        });

        // 计算文本的理想尺寸
        function calculateWindowSize(text) {
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;

            // 根据屏幕尺寸调整最大宽度和字体大小
            let maxWidth, fontSize, lineHeight, minWindowWidth, minWindowHeight;

            if (screenWidth <= 320) {
                // 超小屏幕设备
                maxWidth = Math.min(200, screenWidth * 0.6);
                fontSize = 10;
                lineHeight = 16;
                minWindowWidth = 120;
                minWindowHeight = 50;
            } else if (screenWidth <= 480) {
                // 手机设备
                maxWidth = Math.min(300, screenWidth * 0.5);
                fontSize = 11;
                lineHeight = 18;
                minWindowWidth = 140;
                minWindowHeight = 60;
            } else if (screenWidth <= 768) {
                // 平板设备
                maxWidth = Math.min(400, screenWidth * 0.45);
                fontSize = 12;
                lineHeight = 19;
                minWindowWidth = 160;
                minWindowHeight = 70;
            } else {
                // 桌面设备
                maxWidth = Math.min(500, screenWidth * 0.4);
                fontSize = 14;
                lineHeight = 20;
                minWindowWidth = 200;
                minWindowHeight = 80;
            }

            // 创建临时元素测量文本尺寸
            const tempDiv = document.createElement('div');
            tempDiv.style.cssText = `
                position: absolute;
                visibility: hidden;
                font-family: "Microsoft YaHei", "微软雅黑", sans-serif;
                font-size: ${fontSize}px;
                font-weight: bold;
                white-space: nowrap;
            `;
            tempDiv.textContent = text;
            document.body.appendChild(tempDiv);

            const singleLineWidth = tempDiv.offsetWidth;
            document.body.removeChild(tempDiv);

            // 估算文本高度（考虑换行）
            let baseWidth, baseHeight;

            if (singleLineWidth <= maxWidth * 0.6) {
                baseWidth = singleLineWidth + 40;
                baseHeight = lineHeight * 2 + 30;
            } else if (singleLineWidth <= maxWidth * 0.8) {
                baseWidth = Math.min(singleLineWidth * 0.8 + 50, maxWidth);
                baseHeight = lineHeight * 3 + 40;
            } else {
                const avgCharWidth = fontSize * 0.6;
                const idealCharsPerLine = Math.min(12, text.length / 2);
                baseWidth = Math.min(avgCharWidth * idealCharsPerLine + 80, maxWidth);
                const estimatedLines = Math.max(2, Math.ceil(text.length / idealCharsPerLine));
                baseHeight = lineHeight * estimatedLines + 50;
            }

            // 确保最小尺寸
            baseWidth = Math.max(baseWidth, minWindowWidth);
            baseHeight = Math.max(baseHeight, minWindowHeight);

            // 添加随机性
            const width = Math.floor(baseWidth * (0.9 + Math.random() * 0.2));
            const height = Math.floor(baseHeight * (0.9 + Math.random() * 0.2));

            // 确保窗口不会超出屏幕
            const margin = screenWidth <= 480 ? 20 : 30;
            return {
                width: Math.min(width, screenWidth - margin * 2),
                height: Math.min(height, screenHeight - margin * 2)
            };
        }

        // 创建单个窗口
        function createWindow(tip, index) {
            const size = calculateWindowSize(tip);

            // 根据屏幕尺寸选择位置策略
            const screenWidth = window.innerWidth;
            let positionStrategy;

            if (screenWidth <= 320) {
                // 超小屏幕设备 - 简化位置策略
                positionStrategy = Math.floor(Math.random() * 2); // 只使用完全随机和边缘偏好
            } else if (screenWidth <= 480) {
                // 手机设备 - 减少位置策略
                positionStrategy = Math.floor(Math.random() * 3); // 不使用螺旋分布
            } else {
                // 平板和桌面设备 - 使用所有位置策略
                positionStrategy = Math.floor(Math.random() * 4);
            }

            // 创建更加不规律和分散的随机位置
            // 使用不同的分布策略增加随机性
            let x, y;
            const margin = screenWidth <= 480 ? 10 : 30;

            switch (positionStrategy) {
                case 0: // 完全随机分布
                    x = Math.floor(Math.random() * (window.innerWidth - size.width - margin * 2)) + margin;
                    y = Math.floor(Math.random() * (window.innerHeight - size.height - margin * 2)) + margin;
                    break;
                case 1: // 边缘偏好的分布
                    const edgeBias = screenWidth <= 480 ? 0.3 : 0.5;
                    if (Math.random() < edgeBias) {
                        // 偏向左边缘或右边缘
                        x = Math.random() > 0.5 ?
                            Math.floor(Math.random() * (window.innerWidth * 0.3)) + margin :
                            Math.floor(Math.random() * (window.innerWidth * 0.3)) + window.innerWidth * 0.7 - size.width;
                    } else {
                        x = Math.floor(Math.random() * (window.innerWidth - size.width - margin * 2)) + margin;
                    }
                    y = Math.floor(Math.random() * (window.innerHeight - size.height - margin * 2)) + margin;
                    break;
                case 2: // 螺旋分布
                    if (screenWidth > 480) { // 只在平板和桌面设备上使用
                        const angle = index * 0.5 + Math.random() * 0.5;
                        const radius = 100 + index * 15 + Math.random() * 50;
                        const centerX = window.innerWidth / 2;
                        const centerY = window.innerHeight / 2;
                        x = Math.floor(centerX + Math.cos(angle) * radius - size.width / 2);
                        y = Math.floor(centerY + Math.sin(angle) * radius - size.height / 2);
                        // 确保在屏幕内
                        x = Math.max(margin, Math.min(x, window.innerWidth - size.width - margin));
                        y = Math.max(margin, Math.min(y, window.innerHeight - size.height - margin));
                    } else {
                        // 手机设备使用随机分布
                        x = Math.floor(Math.random() * (window.innerWidth - size.width - margin * 2)) + margin;
                        y = Math.floor(Math.random() * (window.innerHeight - size.height - margin * 2)) + margin;
                    }
                    break;
                case 3: // 网格随机偏移
                    if (screenWidth > 480) { // 只在平板和桌面设备上使用
                        const cols = Math.ceil(Math.sqrt(windowCount));
                        const gridWidth = (window.innerWidth - margin * 2) / cols;
                        const gridHeight = (window.innerHeight - margin * 2) / cols;
                        const col = index % cols;
                        const row = Math.floor(index / cols);
                        x = Math.floor(col * gridWidth + Math.random() * gridWidth * 0.6 + margin);
                        y = Math.floor(row * gridHeight + Math.random() * gridHeight * 0.6 + margin);
                        // 确保不超出屏幕
                        x = Math.min(x, window.innerWidth - size.width - margin);
                        y = Math.min(y, window.innerHeight - size.height - margin);
                    } else {
                        // 手机设备使用随机分布
                        x = Math.floor(Math.random() * (window.innerWidth - size.width - margin * 2)) + margin;
                        y = Math.floor(Math.random() * (window.innerHeight - size.height - margin * 2)) + margin;
                    }
                    break;
            }

            const windowElement = document.createElement('div');
            windowElement.className = 'glass-window fade-in';
            windowElement.style.cssText = `
                left: ${x}px;
                top: ${y}px;
                width: ${size.width}px;
                height: ${size.height}px;
                z-index: ${1000 + Math.floor(Math.random() * 100)}; // 随机z-index增加层次感
            `;

            const tipElement = document.createElement('div');
            tipElement.className = 'tip-text';
            tipElement.textContent = tip;

            windowElement.appendChild(tipElement);
            document.body.appendChild(windowElement);

            // 添加点击关闭功能
            windowElement.addEventListener('click', function () {
                closeWindow(windowElement);
            });

            // 随机延迟启动浮动动画
            const floatDelay = Math.random() * 1000 + 200;
            setTimeout(() => {
                windowElement.classList.add('float-animation');
            }, floatDelay);

            // 随机显示时间，增加变化性
            const displayTime = Math.floor(Math.random() * 2000) + 1500;
            setTimeout(() => {
                closeWindow(windowElement);
            }, displayTime);

            windows.push(windowElement);

            return windowElement;
        }

        // 关闭窗口
        function closeWindow(windowElement) {
            if (windowElement.parentNode) {
                windowElement.classList.remove('float-animation');
                windowElement.classList.add('fade-out');

                setTimeout(() => {
                    if (windowElement.parentNode) {
                        windowElement.parentNode.removeChild(windowElement);
                        const index = windows.indexOf(windowElement);
                        if (index > -1) {
                            windows.splice(index, 1);
                        }
                    }
                }, 500);
            }
        }

        // 开始显示提醒墙
        function startNoteWall() {
            if (isRunning) return;
            isRunning = true;

            // 隐藏按钮并添加淡出动画，使用CSS类控制
            const controls = document.querySelector('.controls-button');
            controls.classList.add('hidden');

            let createdCount = 0;

            function createNextWindow() {
                if (createdCount >= windowCount) {
                    isRunning = false;
                    // 所有窗口创建完成后，等待所有窗口消失后再显示按钮
                    const checkWindows = setInterval(() => {
                        if (windows.length === 0) {
                            clearInterval(checkWindows);
                            // 重新显示按钮并添加淡入动画
                            controls.classList.remove('hidden');
                        }
                    }, 500);
                    return;
                }

                const tip = tips[Math.floor(Math.random() * tips.length)];
                createWindow(tip, createdCount);
                createdCount++;

                // 根据屏幕尺寸调整创建下一个窗口的延迟时间
                const screenWidth = window.innerWidth;
                let delay;

                if (screenWidth <= 320) {
                    // 超小屏幕设备 - 更长的延迟，避免性能问题
                    delay = Math.floor(Math.random() * 600) + 300; // 300-900ms
                } else if (screenWidth <= 480) {
                    // 手机设备 - 中等延迟
                    delay = Math.floor(Math.random() * 500) + 200; // 200-700ms
                } else if (screenWidth <= 768) {
                    // 平板设备 - 稍短的延迟
                    delay = Math.floor(Math.random() * 400) + 150; // 150-550ms
                } else {
                    // 桌面设备 - 较短的延迟
                    delay = Math.floor(Math.random() * 300) + 100; // 100-400ms
                }

                setTimeout(createNextWindow, delay);
            }

            createNextWindow();
        }

        // 主题管理功能
        class ThemeManager {
            constructor() {
                this.currentTheme = 'day';
                this.init();
            }

            init() {
                // 检测当前时间并设置主题
                this.checkTimeAndSetTheme();
                
                // 每分钟检查一次时间变化
                setInterval(() => {
                    this.checkTimeAndSetTheme();
                }, 60000); // 1分钟

                // 监听系统主题变化（如果支持）
                if (window.matchMedia) {
                    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                    mediaQuery.addEventListener('change', (e) => {
                        this.handleSystemThemeChange(e.matches);
                    });
                }
            }

            checkTimeAndSetTheme() {
                const now = new Date();
                const hour = now.getHours();
                
                // 白天：6:00 - 18:00，夜间：18:00 - 6:00
                if (hour >= 6 && hour < 18) {
                    this.setTheme('day');
                } else {
                    this.setTheme('night');
                }
            }

            handleSystemThemeChange(isDark) {
                // 如果用户没有手动切换主题，则跟随系统
                if (!this.hasManualOverride()) {
                    this.setTheme(isDark ? 'night' : 'day');
                }
            }

            setTheme(theme) {
                if (this.currentTheme === theme) return;
                
                this.currentTheme = theme;
                const body = document.body;
                
                // 添加主题切换动画类
                body.classList.add('theme-transitioning');
                
                // 设置主题
                if (theme === 'night') {
                    body.classList.add('night-theme');
                    body.classList.remove('day-theme');
                } else {
                    body.classList.add('day-theme');
                    body.classList.remove('night-theme');
                }
                
                // 保存主题偏好
                this.saveThemePreference(theme);
                
                // 移除动画类
                setTimeout(() => {
                    body.classList.remove('theme-transitioning');
                }, 800);
            }

            saveThemePreference(theme) {
                try {
                    localStorage.setItem('theme-preference', theme);
                } catch (e) {
                    console.warn('无法保存主题偏好设置');
                }
            }

            loadThemePreference() {
                try {
                    return localStorage.getItem('theme-preference');
                } catch (e) {
                    return null;
                }
            }

            hasManualOverride() {
                const savedTheme = this.loadThemePreference();
                return savedTheme !== null;
            }

            // 手动切换主题（供用户调用）
            toggleTheme() {
                const newTheme = this.currentTheme === 'day' ? 'night' : 'day';
                this.setTheme(newTheme);
            }

            // 获取当前主题信息
            getThemeInfo() {
                const now = new Date();
                const hour = now.getHours();
                const isDaytime = hour >= 6 && hour < 18;
                
                return {
                    current: this.currentTheme,
                    isDaytime: isDaytime,
                    nextSwitch: isDaytime ? 
                        `将在 18:00 切换到夜间主题` : 
                        `将在 6:00 切换到白天主题`,
                    timeUntilSwitch: this.calculateTimeUntilSwitch()
                };
            }

            calculateTimeUntilSwitch() {
                const now = new Date();
                const hour = now.getHours();
                let nextSwitchTime;
                
                if (hour >= 6 && hour < 18) {
                    // 当前是白天，下次切换到夜间是18:00
                    nextSwitchTime = new Date(now);
                    nextSwitchTime.setHours(18, 0, 0, 0);
                } else {
                    // 当前是夜间，下次切换到白天是6:00（可能是明天）
                    nextSwitchTime = new Date(now);
                    if (hour >= 18) {
                        // 如果当前时间在18:00之后，明天6:00切换
                        nextSwitchTime.setDate(nextSwitchTime.getDate() + 1);
                    }
                    nextSwitchTime.setHours(6, 0, 0, 0);
                }
                
                const timeDiff = nextSwitchTime - now;
                const hours = Math.floor(timeDiff / (1000 * 60 * 60));
                const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                
                return { hours, minutes };
            }
        }

        // 创建全局主题管理器实例
        let themeManager;

        // 初始化
        document.addEventListener('DOMContentLoaded', function () {
            // 初始化主题管理器
            themeManager = new ThemeManager();
            
            // 加载保存的主题偏好
            const savedTheme = themeManager.loadThemePreference();
            if (savedTheme) {
                themeManager.setTheme(savedTheme);
            }
            
            // 添加主题切换按钮到控制按钮
            const controls = document.querySelector('.controls-button');
            if (controls) {
                // 添加主题切换功能到右键菜单
                controls.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    themeManager.toggleTheme();
                    
                    // 显示主题切换提示
                    showThemeNotification();
                });
                
                // 左键点击显示主题信息
                controls.addEventListener('click', function(e) {
                    // 原有的开始功能保持不变
                    if (!isRunning) {
                        startNoteWall();
                    }
                });
            }

            // 自动开始（可选）
            // setTimeout(startNoteWall, 1000);
        });

        // 显示主题切换通知
        function showThemeNotification() {
            const themeInfo = themeManager.getThemeInfo();
            
            // 创建临时通知元素
            const notification = document.createElement('div');
            notification.className = 'theme-notification fade-in';
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--current-glass-bg);
                backdrop-filter: blur(20px);
                border: 1px solid var(--current-glass-border);
                border-radius: 10px;
                padding: 15px 20px;
                color: var(--current-text-color);
                text-shadow: var(--current-text-shadow);
                font-size: 14px;
                font-weight: bold;
                z-index: 3000;
                max-width: 300px;
                box-shadow: var(--current-glass-shadow);
            `;
            
            notification.innerHTML = `
                <div style="margin-bottom: 8px;">已切换到${themeInfo.current === 'day' ? '白天' : '夜间'}主题</div>
                <div style="font-size: 12px; opacity: 0.8;">${themeInfo.nextSwitch}</div>
                <div style="font-size: 11px; opacity: 0.6; margin-top: 4px;">
                    右键点击按钮可手动切换主题
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // 3秒后自动消失
            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }, 3000);
        }

        // 窗口大小变化时重新计算位置
        window.addEventListener('resize', function () {
            // 可以添加窗口位置调整逻辑
        });
    </script>
</body>

</html>